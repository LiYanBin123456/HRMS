<!DOCTYPE html>
<html class="x-admin-sm">

<head>
    <meta charset="UTF-8">
    <title>添加员工</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"/>
    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/xadmin.css">
    <link href="../city-picker/city-picker.css" rel="stylesheet"/>

    <script type="text/javascript" src="../lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/xadmin.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="layui-tab layui-tab-brief" lay-filter="tab_employ">
    <ul class="layui-tab-title">
        <li class="layui-this">基础信息</li>
        <li>补充信息</li>
        <li>社保设置</li>
        <li>个人专项扣除</li>
        <li>工资卡</li>
    </ul>
    <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
            <form lay-filter="form_employee" class="layui-form layui-row">
                <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
                    <input type="hidden" name="id">
                    <input type="hidden" name="type">
                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>身份证号</label>
                        <div class="layui-input-inline">
                            <input type="text" name="cardId" required="" autocomplete="off" class="layui-input"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>姓名</label>
                        <div class="layui-input-inline">
                            <input type="text" name="name" required="" autocomplete="off" class="layui-input"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>联系电话</label>
                        <div class="layui-input-inline">
                            <input type="text" onkeyup="this.value=this.value.replace(/[^0-9]+/,'');" name="phone"
                                   required="" autocomplete="off" class="layui-input"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span class="x-red">*</span>学历</label>
                        <div class="layui-input-inline">
                            <select name="degree" lay-verify="required">
                                <option value="0">高中以下</option>
                                <option value="1">高中</option>
                                <option value="2">中专</option>
                                <option value="3">大专</option>
                                <option value="4">本科</option>
                                <option value="5">硕士</option>
                                <option value="6">博士</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-col-xs12 layui-col-sm6 layui-col-md6">
                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>入职时间</label>
                        <div class="layui-input-inline">
                            <input type="text" id="entry" name="entry" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item layui-hide" name="t1">
                        <label class="layui-form-label"><span class="x-red">*</span>用工性质</label>
                        <div class="layui-input-inline">
                            <select name="category" lay-verify="required" lay-filter="filter_category">
                                <option value=""></option>
                                <option value="0">派遣</option>
                                <option value="1">外包</option>
                                <option value="2">小时工</option>
                            </select>
                        </div>
                    </div>
                    <div class="layui-form-item layui-hide" name="t2">
                        <label class="layui-form-label"><span class="x-red">*</span>小时工报酬</label>
                        <div class="layui-input-inline">
                            <input type="text" name="price" required="" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item layui-hide" name="t1">
                        <label class="layui-form-label"><span class="x-red">*</span>外派单位</label>
                        <div class="layui-input-inline">
                            <select name="cid" id="select_cooperation" lay-filter="filter_cooperation" lay-verify="required"></select>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">
                            <span class="x-red">*</span>岗位</label>
                        <div class="layui-input-inline">
                            <input type="text" name="post" required="" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label"><span class="x-red">*</span>在职状态</label>
                        <div class="layui-input-inline">
                            <select name="status" lay-verify="required">
                                <option value=""></option>
                                <option value="0">在职</option>
                                <option value="1">离职</option>
                                <option value="2">退休</option>
                                <option value="3">其他</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item" >
                    <div class="layui-input-block">
                        <button type="button" class="layui-btn " onclick="saveEmployee()">保存</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_extra" class="layui-form layui-row">
                <input type="hidden" name="id">
                <div class="layui-form-item">
                    <label class="layui-form-label">档案编号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="rid" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">毕业学校</label>
                    <div class="layui-input-inline">
                        <input type="text" name="school" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">毕业专业</label>
                    <div class="layui-input-inline">
                        <input type="text" name="major" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">户口性质</label>
                    <div class="layui-input-inline">
                        <select name="household">
                            <option value=""></option>
                            <option value="0">外地城镇</option>
                            <option value="1">本地城镇</option>
                            <option value="2">外地农村</option>
                            <option value="3">城镇</option>
                            <option value="4">农村</option>
                            <option value="5">港澳台</option>
                            <option value="6">外籍</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">户籍地址</label>
                    <div class="layui-input-inline">
                        <input type="text" name="address" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">离职时间</label>
                    <div class="layui-input-inline">
                        <input type="text" id="date1" name="date1" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">退休时间</label>
                    <div class="layui-input-inline">
                        <input type="text" id="date2" name="date2" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">离职原因</label>
                    <div class="layui-input-inline">
                        <select name="household">
                            <option value=""></option>
                            <option value="0">合同到期</option>
                            <option value="1">被用人单位解除劳动合同</option>
                            <option value="2">被用人单位开除</option>
                            <option value="3">被用人单位除名</option>
                            <option value="4">被用人单位辞退</option>
                            <option value="5">公司倒闭</option>
                            <option value="6">公司破产</option>
                            <option value="7">单位人员减少</option>
                            <option value="8">养老在职转退休</option>
                            <option value="9">参军</option>
                            <option value="10">入学</option>
                            <option value="11">劳改劳教</option>
                            <option value="12">出国定居</option>
                            <option value="13">异地转移</option>
                            <option value="14">不足缴费年限</option>
                            <option value="15">人员失踪</option>
                            <option value="16">错误申报</option>
                            <option value="17">其他原因减少</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item" >
                    <div class="layui-input-block">
                        <button type="button" class="layui-btn " onclick="saveExtra()">保存</button>
                    </div>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_ensure" class="layui-form">
                <input type="hidden" name="eid">
                <div class="layui-form-item">
                    <label class="layui-form-label">社保所在地</label>
                    <div class="layui-input-block">
                        <input type="text" autocomplete="on" class="layui-input" id="city-picker" name="city" readonly="readonly" data-toggle="city-picker" placeholder="请选择">
                    </div>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>医保</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingM" name="settingM" value="0" title="最低标准" checked>
                                <input type="radio" lay-filter="settingM" name="settingM" value="1" title="实际工资">
                                <input type="radio" lay-filter="settingM" name="settingM" value="2" title="不缴纳">
                                <input type="radio" lay-filter="settingM" name="settingM" value="3" title="自定义基数">
                            </div>
                            <div class="layui-inline layui-hide" name="m1">
                                <input type="text" name="valM" required="" placeholder="自定义基数" autocomplete="off" class="layui-input " onchange="verifyMedicalBase(this.value)">
                            </div>
                        </div>
                        <div class="layui-field-box">
                            <input type="checkbox" lay-skin="primary" name="bMedicare" value="1" title="医疗保险" checked>
                            <input type="checkbox" lay-skin="primary" name="bMedicare" value="2" title="大病保险" checked>
                            <input type="checkbox" lay-skin="primary" name="bMedicare" value="4" title="生育保险" checked>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>社保</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingS" name="settingS" value="0" title="最低标准" checked>
                                <input type="radio" lay-filter="settingS" name="settingS" value="1" title="实际工资">
                                <input type="radio" lay-filter="settingS" name="settingS" value="2" title="不缴纳">
                                <input type="radio" lay-filter="settingS" name="settingS" value="3" title="自定义基数">
                            </div>
                            <div class="layui-inline layui-hide" name="s1">
                                <input type="text" name="valS" required="" placeholder="自定义基数" autocomplete="off" class="layui-input" onchange="verifySocialBase(this.value)" >
                            </div>
                        </div>
                        <div class="layui-field-box">
                            <input type="checkbox" lay-skin="primary" name="bSocial" value="1" title="养老保险" checked>
                            <input type="checkbox" lay-skin="primary" name="bSocial" value="2" title="失业保险" checked>
                            <input type="checkbox" lay-skin="primary" name="bSocial" value="4" title="工伤保险" checked>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>公积金</legend>
                        <div class="layui-field-box">
                            基数
                            <div class="layui-inline" name="f1">
                                <input type="text" name="fundBase" required="" placeholder="基数" autocomplete="off" class="layui-input" onchange="verifyFundBase(this.value)">
                            </div>
                            比例
                            <div class="layui-inline" name="f1">
                                <input type="text" name="fundPer" required="" placeholder="%" autocomplete="off" class="layui-input" onchange="verifyFundPer(this.value)">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>保险产品</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingP" name="product" value="0" title="无" checked>
                                <input type="radio" lay-filter="settingP" name="product" value="1" title="购买">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <button class="layui-btn" onclick="saveEnsureSetting()" type="button">保存</button>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_deduct" class="layui-form">
                <input type="hidden" name="eid">
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>累计收入额
                    </label>
                    <div class="layui-input-inline">
                        <input type="text" name="income" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>累计减除费用
                    </label>
                    <div class="layui-input-inline">
                        <input type="text" name="free" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>累计已预缴税额
                    </label>
                    <div class="layui-input-inline">
                        <input type="text" name="free" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
                    <legend>个税专项扣除累计</legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>子女教育</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct1" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>赡养老人</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct2" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>继续教育</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct3" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>大病医疗</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct4" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>住房贷款利息</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct5" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>住房租金</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct6" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <button type="button" class="layui-btn" onclick="saveDeduct()">保存</button>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_salary_card" class="layui-form">
                <input type="hidden" name="eid">
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>选择发行卡</label>
                    <div class="layui-input-inline">
                        <select name="bank1" lay-verify="required">
                            <option value=""></option>
                            <option value="0">中国银行</option>
                            <option value="1">交通银行</option>
                            <option value="2">建设银行</option>
                            <option value="3">其他</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>开户行</label>
                    <div class="layui-input-inline">
                        <input type="text" name="bank2" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>行号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="bankNo" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>账号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="cardNo" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <button type="button" class="layui-btn" onclick="saveCard()">保存</button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery.params.js"></script>
<script src="../js/interface.js"></script>
<script src="../js/xadmin.js"></script>
<script src="../city-picker/city-picker.data.js"></script>
<script src="../js/fieldSet.js"></script>
<script src="../js/city.js"></script>
<script>
    var op = "insert";
    var form;//表单对象
    var cityPicker;
    var element;
    var laydate;
    var employee = {degree:1,category:0,status:0,entry:new Date().getTime()};

    var extra,setting,deduct,card,city;

    loadLayuiModule();

    function loadLayuiModule() {
        layui.extend({
            index: 'lib/index' //主入口模块
            , citypicker: '../city-picker/city-picker' // {/}的意思即代表采用自有路径，即不跟随 base 路径
        }).use(['form', 'element','citypicker','laydate'], function () {
            form = layui.form;
            laydate = layui.laydate;
            element = layui.element;
            var picker = layui.citypicker;
            cityPicker = new picker("#city-picker", {
                provincename: "provinceId",
                cityname: "city",
                level: 'city',
                onCitySelected:function (code) {
                    city = code;
                }
            });
            laydate.render({
                elem: '#entry'
            });
            laydate.render({
                elem: '#date1'
            });
            laydate.render({
                elem: '#date2'
            });
            initPage();
            initTab();
        });
    }

    function initTab() {
        element.on('tab(tab_employ)', function(data) {
            switch (data.index) {
                case 0:
                    getEmployee();//获取员工基础信息
                    break;
                case 1:
                    getExtra();//获取员工补充信息
                    break;
                case 2:
                    getEnsureSetting();//获取社保设置
                    break;
                case 3:
                    getDeduct();//获取个人专项扣除
                    break;
                case 4:
                    getCard();//获取工资卡详情
                    break;
            }
        });
    }

    function initPage() {
        form.on('radio(settingM)', function(data){
            var settingM = data.value;
            if(settingM == 3){
                $("[name=m1]").removeClass("layui-hide");
            }else{
                $("[name=m1]").addClass("layui-hide");
            }
        });
        form.on('radio(settingS)', function(data){
            var settingS = data.value;
            if(settingS == 3){
                $("[name=s1]").removeClass("layui-hide");
            }else{
                $("[name=s1]").addClass("layui-hide");
            }
        });

        //监听用工性质选项变化
        form.on('select(filter_category)', function(data){
            var category = data.value;
            if(category == 2){
                $("[name=t2]").removeClass("layui-hide");
            }else{
                $("[name=t2]").addClass("layui-hide");
            }
        });
        getEmployee();
        initCooperationList();
    }

    //查询所属的所有合作方
    function initCooperationList() {
        //获取session中的派遣方id
        var param_query ={conditions: {keys:[{k:"type",o:"=",v:0}]},order: {need:false},pagination: {need:false}};
        iClient.getList(param_query,1,function(result){
            var cooperations = result.rows;
            var select_cooperation = $("#select_cooperation");
            select_cooperation.append("<option value='-2' selected disabled hidden>选择合作客户</option>");
            for(var i in cooperations){
                var cooperation = cooperations[i];
                var option = $("<option>").val(cooperation.id).text(cooperation.name);
                select_cooperation.append(option);
            }
            form.render('select', 'form_employee');
        });
    }

    function getEmployee() {
        var id = $.query.get("id");
        if(id){
            iEmployee.get(id,function (result) {
                employee = result.data;
                showEmployee(employee);
                op = "update";
            });
        }else{
            var type = $.query.get("type");
            employee.type = type;
            showEmployee(employee);
        }

        function showEmployee(employee) {
            employee.entry = format_date(employee.entry);
            if(employee.type == 1){
                $("[name=t1]").removeClass("layui-hide");
                if(employee && employee.category==2){
                    $("[name=t2]").removeClass("layui-hide");
                }
            }
            form.val('form_employee', employee);
        }
    }

    function getExtra() {
        if(employee.id){
            iEmployee.getExtra(employee.id,function (result) {
                extra = result.data;
                form.val('form_extra', extra);
            });
        }
    }
    
    function getEnsureSetting () {
        if(employee.id){
            iEmployee.getEnsureSetting(employee.id,function (result) {
                setting = result.data;
                if(setting){
                    form.val('form_ensure',setting);
                    if(setting.settingS == 3){
                        $("[name=s1]").removeClass("layui-hide");
                    }
                    if(setting.settingM == 3){
                        $("[name=m1]").removeClass("layui-hide");
                    }
                    var text = getCityArray2(setting.city);
                    cityPicker.setValue(text);
                }
            });
        }
    }

    function getDeduct() {
        if(employee.id){
            iEmployee.getDeduct(employee.id,function (result) {
                deduct = result.data;
                if(deduct){
                    form.val('form_deduct',deduct);
                }
            })
        }
    }
    
    function getCard() {
        if(employee.id){
            iEmployee.getCard(employee.id,function (result) {
                card = result.data;
                if(card){
                    form.val('form_salary_card',card);
                }
            })
        }
    }
    
    function saveEmployee() {
        var employee = form.val('form_employee');
        var extract = {};
        extract.school = employees.school;
        extract.major = employees.major;
        extract.rid = employees.rid;
        if(employee.id){
            iEmployee.update(employees,0, onUpdateSuccess);
            layer.alert("基础信息保存成功", {icon: 20});
        } else {
            iEmployee.insert(employee, extract);
            layer.alert("基础信息保存成功，请完善社保信息", {icon: 20});
        }
        window.parent.location.reload();
    }

    function saveExtra() {
        var extra = form.val('form_extra');
        extra.eid = employee.id;
        if(op == "insert"){
            iEmployee.insertExtra(extra);
            layer.alert("社保信息保存成功，请完善个人专项扣除", {icon: 20});
        }else{
            iEmployee.updateExtra(extra,onUpdateSuccess);
        }
    }

    function saveEnsureSetting() {
        var setting = form.val('form_ensure');
        if(!setting.city){
            layer.alert("请选择社保所在地", {icon: 20});
            return;
        }
        setting.eid = employee.id;
        setting.medicare = 0;
        $('input[name=bMedicare]:checked').each(function() {
            setting.medicare += Number($(this).val());
        });
        setting.social = 0;
        $('input[name=bSocial]:checked').each(function() {
            setting.social += Number($(this).val());
        });
        if(op == "insert"){
            iEmployee.insertEnsureSetting(setting);
            layer.alert("社保信息保存成功，请完善个人专项扣除", {icon: 20});
        }else{
            iEmployee.updateEnsureSetting(setting,onUpdateSuccess);
        }
    }

    function saveDeduct() {
        var deduct = form.val('form_deduct');
        deduct.eid = employee.id;
        if(op ==  "insert"){
            iEmployee.insertDeduct(deduct);
            layer.alert("个人专项扣除信息保存成功，请完善工资卡信息", {icon: 20});
        }else {
            iEmployee.updateDeduct(deduct,onUpdateSuccess);
        }

    }

    function saveCard() {
        var payCard = form.val('form_salary_card');
        payCard.eid = employee.id;
        if(op == "insert"){
            iEmployee.insertCard(payCard,onInsertSuccess);
        }else {
            iEmployee.updateCard(payCard,onUpdateSuccess);
        }
    }

    function verifyMedicalBase(base) {
        if(!city){
            layer.msg("请先选择社保所在地");
        }
        iRule.getLast(city,0,function (result) {
            if(base < result.data.base){
                layer.msg("自定义医保基数不能低于最低基数"+result.data.base);
            };
        });
    }

    function verifySocialBase(base) {
        if(!city){
            layer.msg("请先选择社保所在地");
        }
        iRule.getLast(city,1,function (result) {
            if(base < result.data.base){
                layer.msg("自定义社保基数不能低于最低基数"+result.data.base);
            };
        });
    }

    function verifyFundBase(base) {
        if(!city){
            layer.msg("请先选择社保所在地");
        }
        console.log(city);
        iRule.getLast(city,2,function (result) {
            if(base < result.data.min || base > result.data.max){
                layer.msg("公积金基数必须介于["+result.data.min+","+result.data.max+"]");
            };
        });
    }

    function verifyFundPer(per) {
        if(!city){
            layer.msg("请先选择社保所在地");
        }
        console.log(city);
        iRule.getLast(city,2,function (result) {
            if(per < result.data.per1 || per > result.data.per2){
                layer.msg("公积金缴纳比例必须介于["+result.data.per1+","+result.data.per2+"]");
            };
        });
    }

    function onInsertSuccess() {
        layer.alert("添加成功", {icon: 6,time:2000},function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
            window.parent.location.reload();
        });
    }

    function onUpdateSuccess() {
        layer.alert("修改成功", {icon: 6,time:2000},function () {
            var index = parent.layer.getFrameIndex(window.name);
            parent.layer.close(index);
            window.parent.location.reload();
        });
    }


</script>

</html>