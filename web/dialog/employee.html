<!DOCTYPE html>
<html class="x-admin-sm">

<head>
    <meta charset="UTF-8">
    <title>添加员工</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"/>
    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/xadmin.css">
    <link href="../city-picker/city-picker.css" rel="stylesheet"/>

    <script type="text/javascript" src="../lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="../js/xadmin.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
    <ul class="layui-tab-title">
        <li class="layui-this">基础信息</li>
        <li>社保设置</li>
        <li>个人专项扣除</li>
        <li>工资卡</li>
    </ul>
    <div class="layui-tab-content">
        <div class="layui-tab-item layui-show">
            <form lay-filter="form_expatriate" class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>档案编号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="rid" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>身份证号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="cardId" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>姓名</label>
                    <div class="layui-input-inline">
                        <input type="text" name="name" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>联系电话</label>
                    <div class="layui-input-inline">
                        <input type="text" onkeyup="this.value=this.value.replace(/[^0-9]+/,'');" name="phone"
                               required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>学历</label>
                    <div class="layui-input-inline">
                        <select name="degree" lay-verify="required">
                            <option value=""></option>
                            <option value="0">本科</option>
                            <option value="1">大专</option>
                            <option value="2">其他</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>毕业学校</label>
                    <div class="layui-input-inline">
                        <input type="text" name="school" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>毕业专业</label>
                    <div class="layui-input-inline">
                        <input type="text" name="major" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>入职时间</label>
                    <div class="layui-input-inline">
                        <input type="text" name="entry" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>用工性质</label>
                    <div class="layui-input-inline">
                        <select name="category" lay-verify="required">
                            <option value=""></option>
                            <option value="0">派遣</option>
                            <option value="1">外包</option>
                            <option value="2">小时工</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>小时工报酬</label>
                    <div class="layui-input-inline">
                        <input type="text" name="price" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>在职状态</label>
                    <div class="layui-input-inline">
                        <select name="status" lay-verify="required">
                            <option value=""></option>
                            <option value="0">在职</option>
                            <option value="1">离职</option>
                            <option value="2">退休</option>
                            <option value="3">其他</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>外派单位</label>
                    <div class="layui-input-inline">
                        <select name="department" lay-verify="required">
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>岗位</label>
                    <div class="layui-input-inline">
                        <input type="text" name="post" required="" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"></label>
                    <button type="button" class="layui-btn" id="test1"><i class="layui-icon">&#xe67c;</i>上传照片</button>
                </div>
                <div class="layui-form-item">
                    <button class="layui-btn" lay-filter="add" lay-submit="">保存</button>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_security" class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red"></span>社保所在地</label>
                    <div class="layui-input-inline">
                        <input type="text" autocomplete="on" class="layui-input" id="city-picker" name="city-picker"
                               readonly="readonly" data-toggle="city-picker" placeholder="请选择">
                    </div>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>医保</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingM" name="settingM" value="0" title="最低标准" checked>
                                <input type="radio" lay-filter="settingM" name="settingM" value="1" title="实际工资">
                                <input type="radio" lay-filter="settingM" name="settingM" value="2" title="不缴纳">
                                <input type="radio" lay-filter="settingM" name="settingM" value="3" title="自定义基数">
                            </div>
                            <div class="layui-inline layui-hide" name="m1">
                                <input type="text" name="valueM" required="" placeholder="自定义基数" autocomplete="off" class="layui-input ">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>社保</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingS" name="settingS" value="0" title="最低标准" checked>
                                <input type="radio" lay-filter="settingS" name="settingS" value="1" title="实际工资">
                                <input type="radio" lay-filter="settingS" name="settingS" value="2" title="不缴纳">
                                <input type="radio" lay-filter="settingS" name="settingS" value="3" title="自定义基数">
                            </div>
                            <div class="layui-inline layui-hide" name="s1">
                                <input type="text" name="valueS" required="" placeholder="自定义基数" autocomplete="off" class="layui-input ">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>公积金</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingF" name="settingF" value="0" title="按比例交" checked>
                                <input type="radio" lay-filter="settingF" name="settingF" value="1" title="自定义金额">
                            </div>
                            <div class="layui-inline" name="f1">
                                <input type="text" name="fundBase" required="" placeholder="基数"
                                       autocomplete="off" class="layui-input">
                            </div>
                            <div class="layui-inline" name="f1">
                                <input type="text" name="fundPer" required="" placeholder="%"
                                       autocomplete="off" class="layui-input">
                            </div>
                            <div class="layui-inline layui-hide" name="f2">
                                <input type="text" name="fund" required="" placeholder="自定义金额" autocomplete="off" class="layui-input ">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <fieldset class="layui-elem-field">
                        <legend>保险产品</legend>
                        <div class="layui-field-box">
                            <div class="layui-inline">
                                <input type="radio" lay-filter="settingP" name="settingP" value="0" title="无" checked>
                                <input type="radio" lay-filter="settingP" name="settingP" value="1" title="购买">
                            </div>
                            <div class="layui-inline layui-hide" name="p1">
                                <input type="checkbox" name="product[1]" title="用工宝">
                                <input type="checkbox" name="product[2]" title="产品1">
                                <input type="checkbox" name="product[3]" title="产品2">
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="layui-form-item">
                    <button class="layui-btn" lay-filter="add" lay-submit="">保存</button>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_reduct" class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>子女教育</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct1" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>赡养老人</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct2" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>继续教育</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct3" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>大病医疗</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct4" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>住房贷款利息</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct5" required="" autocomplete="off"
                               class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">
                        <span class="x-red">*</span>住房租金</label>
                    <div class="layui-input-inline">
                        <input type="text" name="deduct6" required="" autocomplete="off" class="layui-input"></div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"></label>
                    <button class="layui-btn" lay-filter="add" onclick="save()" lay-submit="">保存</button>
                </div>
            </form>
        </div>
        <div class="layui-tab-item">
            <form lay-filter="form_salary_card" class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>选择发行卡</label>
                    <div class="layui-input-inline">
                        <select name="bank1" lay-verify="required">
                            <option value=""></option>
                            <option value="0">中国银行</option>
                            <option value="1">交通银行</option>
                            <option value="2">建设银行</option>
                            <option value="3">其他</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>开户行</label>
                    <div class="layui-input-inline">
                        <input type="text" name="bank2" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>行号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="bankNo" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label"><span class="x-red">*</span>账号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="cardNo" required="" autocomplete="off"
                               class="layui-input">
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/jquery.params.js"></script>
<script src="../js/interface.js"></script>
<script src="../city-picker/city-picker.data.js"></script>
<script>
    var op = "insert";
    var form;//表单对象
    var editer;
    var cityPicker;

    loadLayuiModule();

    function loadLayuiModule() {
        layui.extend({
            index: 'lib/index' //主入口模块
            , citypicker: '../city-picker/city-picker' // {/}的意思即代表采用自有路径，即不跟随 base 路径
        }).use(['form', 'layedit', 'citypicker'], function () {
            form = layui.form;
            layedit = layui.layedit;
            var picker = layui.citypicker;
            editer = layedit.build('content'); //建立编辑器
            cityPicker = new picker("#city-picker", {
                provincename: "provinceId",
                cityname: "city",
                level: 'cityId'// 级别
            });
            initPage();
        });
    }


    function initPage() {
        form.on('radio(settingM)', function(data){
            var settingM = data.value;
            if(settingM == 3){
                $("[name=m1]").removeClass("layui-hide");
            }else{
                $("[name=m1]").addClass("layui-hide");
            }
        });
        form.on('radio(settingS)', function(data){
            var settingS = data.value;
            if(settingS == 3){
                $("[name=s1]").removeClass("layui-hide");
            }else{
                $("[name=s1]").addClass("layui-hide");
            }
        });
        form.on('radio(settingF)', function(data){
            var settingF = data.value;
            if(settingF == 0){
                $("[name=f1]").removeClass("layui-hide");
                $("[name=f2]").addClass("layui-hide");
            }else{
                $("[name=f1]").addClass("layui-hide");
                $("[name=f2]").removeClass("layui-hide");
            }
        });
        form.on('radio(settingP)', function(data){
            var settingP = data.value;
            if(settingP == 1){
                $("[name=p1]").removeClass("layui-hide");
            }else{
                $("[name=p1]").addClass("layui-hide");
            }
        });
        initData();
    }

    function initData() {
        var param = $.query.get("expatriate");
        if (param) {
            var expatriate = JSON.parse(param);
            form.val('form_expatriate', employee);
            layedit.setContent(editer, employee.content, false);
            op = "update";
        }
    }

    function save() {
        var notice = form.val('form_expatriate');
        if (op == "insert") {
            iExpatriate.insert(expatriate, onInsertSuccess);
        } else {
            iExpatriate.update(expatriate, onUpdateSuccess);
        }

        function onInsertSuccess() {
            layer.alert("添加成功", {icon: 6}, refresh());
        }

        function onUpdateSuccess() {
            layer.alert("修改成功", {icon: 6}, refresh());
        }

        function refresh() {
            // 获得frame索引
            var index = parent.layer.getFrameIndex(window.name);
            //关闭当前frame
            parent.layer.close(index);
            //修改成功后刷新父界面
            window.parent.location.reload();
        }
    }
</script>

</html>